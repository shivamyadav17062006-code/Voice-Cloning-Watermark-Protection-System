<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VoiceGuard â€” Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;800&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <div class="grid-bg"></div>
  <nav class="topnav">
    <div class="nav-logo">ğŸ” VOICE<span>GUARD</span></div>
    <div class="nav-user">
      <div class="user-pill"><span class="user-dot"></span><span id="userLabel">Loadingâ€¦</span></div>
      <button class="logout-btn" onclick="logout()">LOGOUT</button>
    </div>
  </nav>
  <div class="container">
    <header>
      <div class="live-badge">LIVE SYSTEM</div>
      <h1>VOICE<span>GUARD</span></h1>
      <p class="subtitle">// FFT-Based Audio Authentication & Watermarking System</p>
    </header>
    <div class="stats-bar">
      <div class="stat-card"><div class="num" id="statScans">0</div><div class="label">Files Scanned</div></div>
      <div class="stat-card"><div class="num" id="statFlagged">0</div><div class="label">Threats Detected</div></div>
      <div class="stat-card"><div class="num" id="statAuth">0</div><div class="label">Authenticated</div></div>
      <div class="stat-card"><div class="num" id="statProtected">0</div><div class="label">Files Protected</div></div>
    </div>
    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('detect',this)">ğŸ” DETECT</button>
      <button class="tab-btn" onclick="switchTab('record',this)">ğŸ¤ RECORD</button>
      <button class="tab-btn" onclick="switchTab('protect',this)">ğŸ” PROTECT</button>
      <button class="tab-btn" onclick="switchTab('history',this)">ğŸ“‹ HISTORY</button>
    </div>
    <!-- DETECT -->
    <div class="panel active" id="panel-detect">
      <div class="upload-zone" id="detectZone" onclick="document.getElementById('detectInput').click()" ondragover="handleDragOver(event,'detectZone')" ondragleave="handleDragLeave('detectZone')" ondrop="handleDrop(event,'detectInput','detectZone')">
        <span class="upload-icon">ğŸµ</span>
        <h3>Drop audio here or click to upload</h3>
        <p>WAV Â· MP3 Â· OGG Â· FLAC Â· M4A supported</p>
        <input type="file" id="detectInput" accept="audio/*" style="display:none" onchange="onFileChosen('detectInput','detectFileLabel','detectAnalyzeBtn','detectWave')"/>
        <div class="file-chosen" id="detectFileLabel"></div>
      </div>
      <div class="waveform-container" id="detectWaveWrap"><canvas class="waveform" id="detectWave"></canvas></div>
      <div class="loading-bar" id="detectLoader"></div>
      <p class="loading-text" id="detectLoaderTxt">Applying FFT analysisâ€¦</p>
      <button class="action-btn" id="detectAnalyzeBtn" disabled onclick="runDetect()">ANALYZE AUDIO</button>
      <div class="result-card" id="detectResult">
        <div class="verdict-row">
          <div class="verdict-badge"><div class="vicon" id="rIcon"></div><div class="vtext"><h2 id="rVerdict"></h2><p id="rRiskLabel"></p></div></div>
          <div class="risk-pill" id="rRisk"></div>
        </div>
        <div class="conf-section">
          <div class="conf-labels"><span>CONFIDENCE</span><span id="rConf"></span></div>
          <div class="conf-track"><div class="conf-fill" id="rConfFill"></div></div>
        </div>
        <div class="meta-grid">
          <div class="meta-item"><div class="mk">File</div><div class="mv" id="rFile"></div></div>
          <div class="meta-item"><div class="mk">Duration</div><div class="mv" id="rDuration"></div></div>
          <div class="meta-item"><div class="mk">FFT Score</div><div class="mv" id="rScore"></div></div>
        </div>
        <button class="outline-btn" onclick="downloadReport()">ğŸ“„ DOWNLOAD FORENSIC REPORT</button>
      </div>
    </div>
    <!-- RECORD -->
    <div class="panel" id="panel-record">
      <div class="record-panel">
        <p class="panel-intro">Record your voice directly â€” no file upload needed</p>
        <div class="big-mic-wrap">
          <div class="big-mic-ring" id="bigMicRing">
            <button class="big-mic-btn" id="bigMicBtn" onclick="toggleLiveRecord()"><span id="bigMicIcon">ğŸ™ï¸</span></button>
            <svg class="big-ring-svg" viewBox="0 0 160 160">
              <circle class="big-ring-track" cx="80" cy="80" r="72"/>
              <circle class="big-ring-fill" id="bigRingFill" cx="80" cy="80" r="72"/>
            </svg>
          </div>
        </div>
        <p class="rec-time" id="recTimeDisplay">0.0s</p>
        <p class="rec-hint" id="recHint">Click to start recording</p>
        <canvas class="live-wave" id="liveWaveCanvas"></canvas>
        <div class="record-actions" id="recordActions" style="display:none">
          <audio id="previewAudio" controls style="width:100%;margin-bottom:12px;border-radius:8px;"></audio>
          <div style="display:flex;gap:10px;">
            <button class="action-btn" style="flex:1" onclick="analyzeRecording()">ğŸ” ANALYZE THIS</button>
            <button class="action-btn" style="flex:1;background:var(--s2);color:var(--text);" onclick="protectRecording()">ğŸ” PROTECT THIS</button>
            <button class="outline-btn" style="flex:0.5;margin-top:0;" onclick="resetRecording()">â†º REDO</button>
          </div>
        </div>
        <div class="result-card" id="recordResult" style="margin-top:16px"></div>
      </div>
    </div>
    <!-- PROTECT -->
    <div class="panel" id="panel-protect">
      <div class="upload-zone" id="protectZone" onclick="document.getElementById('protectInput').click()" ondragover="handleDragOver(event,'protectZone')" ondragleave="handleDragLeave('protectZone')" ondrop="handleDrop(event,'protectInput','protectZone')">
        <span class="upload-icon">ğŸ™ï¸</span>
        <h3>Upload original audio to watermark</h3>
        <p>Embeds an inaudible FFT signature â€” sounds identical after</p>
        <input type="file" id="protectInput" accept="audio/*" style="display:none" onchange="onFileChosen('protectInput','protectFileLabel','protectEmbedBtn','protectWave')"/>
        <div class="file-chosen" id="protectFileLabel"></div>
      </div>
      <div class="waveform-container" id="protectWaveWrap"><canvas class="waveform" id="protectWave"></canvas></div>
      <div class="loading-bar" id="protectLoader"></div>
      <p class="loading-text" id="protectLoaderTxt">Embedding FFT watermarkâ€¦</p>
      <button class="action-btn" id="protectEmbedBtn" disabled onclick="runProtect()">EMBED WATERMARK</button>
      <div class="success-card" id="protectSuccess">
        <div class="big-check">âœ…</div><h2>Watermark Embedded!</h2>
        <p id="protectSuccessMsg"></p>
        <p style="color:var(--green);font-family:var(--mono);font-size:.8rem;margin-top:8px">Download started automatically.</p>
      </div>
    </div>
    <!-- HISTORY -->
    <div class="panel" id="panel-history">
      <div class="history-wrap">
        <table class="htable">
          <thead><tr><th>File</th><th>Verdict</th><th>Confidence</th><th>Duration</th><th>Time</th><th>Listen</th></tr></thead>
          <tbody id="historyBody"><tr><td colspan="6"><div style="padding:32px;text-align:center;color:var(--muted);font-family:var(--mono);font-size:.8rem">No scans yet</div></td></tr></tbody>
        </table>
      </div>
    </div>
    <div class="how-section">
      <h3 class="section-label">// HOW IT WORKS</h3>
      <div class="steps">
        <div class="step"><div class="step-num">01</div><h4>FFT Transform</h4><p>Audio is converted to the frequency domain via Fast Fourier Transform â€” revealing the hidden frequency fingerprint.</p></div>
        <div class="step"><div class="step-num">02</div><h4>Signature Analysis</h4><p>10 secret frequency bins are checked for elevated magnitude â€” our invisible stamp that survives compression.</p></div>
        <div class="step"><div class="step-num">03</div><h4>Forensic Report</h4><p>A confidence score is returned with a downloadable forensic report suitable for legal and evidentiary use.</p></div>
      </div>
    </div>
  </div>
  <div class="toast" id="toast"></div>
  <footer>Built at <span>OVERCLOCK 24</span> &nbsp;Â·&nbsp; VoiceGuard v2.0 &nbsp;Â·&nbsp; FFT Signal Processing &nbsp;Â·&nbsp; Python + Flask</footer>
  <script src="script.js"></script>
</body>
</html>
